# 11c24ea214e052cb6870d92d86cf6f10
&lt;?php $ip = '2001:1388:b4b:342e:ad92:a9e7:bc5b:9340'; function ip62long($ipv6) { return (string) gmp_import(inet_pton($ipv6)); } function queryIP2Location($myip) { $user = 'sys'; $pass = '12345'; $host = 'localhost'; $port = 1521; $service = 'XE'; $tns = ' (DESCRIPTION = (ADDRESS_LIST = (ADDRESS = (PROTOCOL = TCP)(HOST = ' . $host . ')(PORT = ' . $port . ')) ) (CONNECT_DATA = (SERVICE_NAME = ' . $service . ') ) )'; if ($conn = oci_connect($user, $pass, $tns, 'AL32UTF8', OCI_SYSDBA)) { if (filter_var($myip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV4)) { $myip = '::FFFF:' . $myip; } if (filter_var($myip, FILTER_VALIDATE_IP, FILTER_FLAG_IPV6)) { $ipnum = ip62long($myip); } // pad ipnum to 39 digits with zeroes in front so we can do string comparison $ipnum = str_pad($ipnum, 39, '0', STR_PAD_LEFT); $stid = oci_parse($conn, 'SELECT * FROM ip2location_db25_ipv6 WHERE :ip_num &lt;= ip_to ORDER BY ip_to FETCH FIRST 1 ROWS ONLY'); oci_bind_by_name($stid, ':ip_num', $ipnum); oci_execute($stid); $num = oci_fetch_all($stid, $res, 0, -1, OCI_FETCHSTATEMENT_BY_ROW); oci_close($conn); if ($num > 0) { return $res[0]; } else { die('No record found.' . "&lt;br>\n"); } } else { $err = oci_error(); die('Error: ' . $err['message'] . "&lt;br>\n"); } } $myresult = queryIP2Location($ip); echo 'COUNTRY_CODE: ' . $myresult["COUNTRY_CODE"] . "&lt;br>\n"; echo 'COUNTRY_NAME: ' . $myresult["COUNTRY_NAME"] . "&lt;br>\n"; echo 'REGION_NAME: ' . $myresult["REGION_NAME"] . "&lt;br>\n"; echo 'CITY_NAME: ' . $myresult["CITY_NAME"] . "&lt;br>\n"; echo 'LATITUDE: ' . $myresult["LATITUDE"] . "&lt;br>\n"; echo 'LONGITUDE: ' . $myresult["LONGITUDE"] . "&lt;br>\n"; echo 'ZIP_CODE: ' . $myresult["ZIP_CODE"] . "&lt;br>\n"; echo 'TIME_ZONE: ' . $myresult["TIME_ZONE"] . "&lt;br>\n"; echo 'ISP: ' . $myresult["ISP"] . "&lt;br>\n"; echo 'DOMAIN: ' . $myresult["DOMAIN"] . "&lt;br>\n"; echo 'NET_SPEED: ' . $myresult["NET_SPEED"] . "&lt;br>\n"; echo 'IDD_CODE: ' . $myresult["IDD_CODE"] . "&lt;br>\n"; echo 'AREA_CODE: ' . $myresult["AREA_CODE"] . "&lt;br>\n"; echo 'WEATHER_STATION_CODE: ' . $myresult["WEATHER_STATION_CODE"] . "&lt;br>\n"; echo 'WEATHER_STATION_NAME: ' . $myresult["WEATHER_STATION_NAME"] . "&lt;br>\n"; echo 'MCC: ' . $myresult["MCC"] . "&lt;br>\n"; echo 'MNC: ' . $myresult["MNC"] . "&lt;br>\n"; echo 'MOBILE_BRAND: ' . $myresult["MOBILE_BRAND"] . "&lt;br>\n"; echo 'ELEVATION: ' . $myresult["ELEVATION"] . "&lt;br>\n"; echo 'USAGE_TYPE: ' . $myresult["USAGE_TYPE"] . "&lt;br>\n"; echo 'ADDRESS_TYPE: ' . $myresult["ADDRESS_TYPE"] . "&lt;br>\n"; echo 'CATEGORY: ' . $myresult["CATEGORY"] . "&lt;br>\n"; ?>
